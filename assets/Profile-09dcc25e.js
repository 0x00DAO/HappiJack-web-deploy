var k=Object.defineProperty;var x=(n,a,t)=>a in n?k(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t;var s=(n,a,t)=>(x(n,typeof a!="symbol"?a+"":a,t),t);import{bb as E,bc as p,bd as y,be as A,aQ as c,aM as S,bf as j,q as l,s as T,n as w,l as b,o as r,S as f,C as H,B as R,a8 as B}from"./index-ed16ce17.js";import{s as L,c as O}from"./Loading-c68b581d.js";import{T as g}from"./index-6ae79340.js";import{R as P,C as z}from"./row-fd2abab0.js";import"./index-6f4aab4b.js";import"./TextArea-5b1b118c.js";const u=class extends E{constructor(){super(...arguments);s(this,"Owner",null);s(this,"TokenType",c.ChainToken);s(this,"TokenAddress",null);s(this,"Amount","0")}get _primaryKey(){return""}get primaryKey(){return[p(y.from(this.Owner).toHexString(),32),p(y.from(this.TokenType).toHexString(),32),p(y.from(this.TokenAddress).toHexString(),32)]}static get attributes(){return[{key:"TokenType",type:"address"},{key:"TokenType",type:"uint256",format:t=>parseInt(t.toString())},{key:"TokenAddress",type:"address"},{key:"Amount",type:"uint256",format:t=>A(t)}]}static formatter(t,o){return u.fillWith(super.formatter(t,o))}};let d=u;s(d,"tableName","WalletSafeBoxTable");class m extends S{constructor(){super(...arguments);s(this,"Amount","0");s(this,"TokenType",c.ChainToken);s(this,"TokenAddress",null);s(this,"Owner",null)}get tokenSymbol(){return this.TokenType===c.ChainToken,"ETH"}get isEmpty(){return!this.Amount||j(this.Amount).lte(y.from(0))}async withdrawETH(){await(await l.instance.getContract(T.LotteryGameLotteryWalletSafeBoxSystem)).withdrawETH()}async withdrawERC20(){await(await l.instance.getContract(T.LotteryGameLotteryWalletSafeBoxSystem)).withdrawERC20(this.TokenAddress)}async withdraw(){this.TokenType===c.ChainToken?await this.withdrawETH():await this.withdrawERC20()}static async create(t=c.ChainToken,o="0x"){const h=await l.instance.getContract(T.GameRoot).getContract(),e=await l.instance.getAddress(),C=await d.queryByKeys(h,[e,t,o],1),i=new m;return i.TokenType=t,i.TokenAddress=o,i.Owner=e,i.Amount=C[0].Amount,i}}function v(){const[n,a]=w.useState(new m),t=async()=>{const e=await m.create();a(e)},o=async()=>{try{L(),await n.withdraw(),await t()}catch(e){B.error(e!=null&&e.message&&e.message.length<30?e.message:"claim failed")}finally{O()}},h=b();return w.useEffect(()=>{async function e(){await t()}e()},[h.pathname]),r.jsx(r.Fragment,{children:r.jsxs(f,{direction:"vertical",size:"large",style:{display:"grid",justifyContent:"center",alignContent:"center",minHeight:`${H}`},children:[r.jsx(P,{gutter:0,children:r.jsxs(z,{span:"auto",style:{maxWidth:"100%"},children:[r.jsx(g.Text,{style:{fontSize:50,color:"#52c41a",display:"grid",justifyContent:"center",alignContent:"center"},children:"Total Amount"}),r.jsx(g.Text,{style:{fontSize:50,color:"#52c41a",display:"grid",justifyContent:"center",alignContent:"center"},children:n.Amount+" "+n.tokenSymbol})]})}),r.jsx(f,{style:{display:"flex",justifyContent:"center",alignContent:"center"},children:r.jsx(R,{style:{fontSize:30,width:300,height:80},type:"primary",onClick:o,disabled:n.isEmpty,children:"Claim"})})]})})}export{v as default};
