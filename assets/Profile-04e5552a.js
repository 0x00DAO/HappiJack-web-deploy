var x=Object.defineProperty;var k=(n,a,t)=>a in n?x(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t;var s=(n,a,t)=>(k(n,typeof a!="symbol"?a+"":a,t),t);import{bb as A,bc as p,bd as y,be as E,aM as c,aJ as S,bf as j,C as l,q as u,n as f,l as b,o as r,S as T,B as H,a6 as R}from"./index-2404be77.js";import{s as B,c as L}from"./Loading-c3dbf84f.js";import{T as g}from"./index-17097477.js";import{R as O,C as P}from"./row-a4e8a325.js";import"./index-53046f57.js";import"./TextArea-986db74c.js";const w=class extends A{constructor(){super(...arguments);s(this,"Owner",null);s(this,"TokenType",c.ChainToken);s(this,"TokenAddress",null);s(this,"Amount","0")}get _primaryKey(){return""}get primaryKey(){return[p(y.from(this.Owner).toHexString(),32),p(y.from(this.TokenType).toHexString(),32),p(y.from(this.TokenAddress).toHexString(),32)]}static get attributes(){return[{key:"TokenType",type:"address"},{key:"TokenType",type:"uint256",format:t=>parseInt(t.toString())},{key:"TokenAddress",type:"address"},{key:"Amount",type:"uint256",format:t=>E(t)}]}static formatter(t,o){return w.fillWith(super.formatter(t,o))}};let d=w;s(d,"tableName","WalletSafeBoxTable");class m extends S{constructor(){super(...arguments);s(this,"Amount","0");s(this,"TokenType",c.ChainToken);s(this,"TokenAddress",null);s(this,"Owner",null)}get tokenSymbol(){return this.TokenType===c.ChainToken,"ETH"}get isEmpty(){return!this.Amount||j(this.Amount).lte(y.from(0))}async withdrawETH(){await(await l.instance.getContract(u.LotteryGameLotteryWalletSafeBoxSystem)).withdrawETH()}async withdrawERC20(){await(await l.instance.getContract(u.LotteryGameLotteryWalletSafeBoxSystem)).withdrawERC20(this.TokenAddress)}async withdraw(){this.TokenType===c.ChainToken?await this.withdrawETH():await this.withdrawERC20()}static async create(t=c.ChainToken,o="0x"){const h=await l.instance.getContract(u.GameRoot).getContract(),e=await l.instance.getAddress(),C=await d.queryByKeys(h,[e,t,o],1),i=new m;return i.TokenType=t,i.TokenAddress=o,i.Owner=e,i.Amount=C[0].Amount,i}}function N(){const[n,a]=f.useState(new m),t=async()=>{const e=await m.create();a(e)},o=async()=>{try{B(),await n.withdraw(),await t()}catch(e){R.error(e!=null&&e.message&&e.message.length<30?e.message:"claim failed")}finally{L()}},h=b();return f.useEffect(()=>{async function e(){await t()}e()},[h.pathname]),r.jsx(r.Fragment,{children:r.jsxs(T,{direction:"vertical",size:"large",style:{display:"grid",justifyContent:"center",alignContent:"center",minHeight:"calc(100vh - 64px - 64px)"},children:[r.jsx(O,{gutter:0,children:r.jsxs(P,{span:"auto",style:{maxWidth:"100%"},children:[r.jsx(g.Text,{style:{fontSize:50,color:"#52c41a",display:"grid",justifyContent:"center",alignContent:"center"},children:"Total Amount"}),r.jsx(g.Text,{style:{fontSize:50,color:"#52c41a",display:"grid",justifyContent:"center",alignContent:"center"},children:n.Amount+" "+n.tokenSymbol})]})}),r.jsx(T,{style:{display:"flex",justifyContent:"center",alignContent:"center"},children:r.jsx(H,{style:{fontSize:30,width:300,height:80},type:"primary",onClick:o,disabled:n.isEmpty,children:"Claim"})})]})})}export{N as default};
