var x=Object.defineProperty;var E=(n,a,t)=>a in n?x(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t;var s=(n,a,t)=>(E(n,typeof a!="symbol"?a+"":a,t),t);import{bb as A,bc as g,bd as m,be as S,aQ as l,aM as b,bf as j,q as d,s as w,a6 as H,bg as B,n as p,l as R,a8 as u,o as r,S as C,C as W,B as L}from"./index-1006b91f.js";import{s as O,c as P}from"./Loading-2547630d.js";import{T as k}from"./index-001bfdae.js";import{R as z,C as G}from"./row-b0bdc5cd.js";import"./CheckOutlined-ad46243b.js";import"./useLocale-0cc99605.js";import"./TextArea-e19ead49.js";const T=class extends A{constructor(){super(...arguments);s(this,"Owner",null);s(this,"TokenType",l.ChainToken);s(this,"TokenAddress",null);s(this,"Amount","0")}get _primaryKey(){return""}get primaryKey(){return[g(m.from(this.Owner).toHexString(),32),g(m.from(this.TokenType).toHexString(),32),g(m.from(this.TokenAddress).toHexString(),32)]}static get attributes(){return[{key:"TokenType",type:"address"},{key:"TokenType",type:"uint256",format:t=>parseInt(t.toString())},{key:"TokenAddress",type:"address"},{key:"Amount",type:"uint256",format:t=>t&&t.toString()!=="0x"?S(t):"0"}]}static formatter(t,i){return T.fillWith(super.formatter(t,i))}};let y=T;s(y,"tableName","WalletSafeBoxTable");class h extends b{constructor(){super(...arguments);s(this,"Amount","0");s(this,"TokenType",l.ChainToken);s(this,"TokenAddress",null);s(this,"Owner",null)}get tokenSymbol(){return this.TokenType===l.ChainToken,"ETH"}get isEmpty(){return!this.Amount||j(this.Amount).lte(m.from(0))}async withdrawETH(){await(await d.instance.getContract(w.LotteryGameLotteryWalletSafeBoxSystem)).withdrawETH()}async withdrawERC20(){await(await d.instance.getContract(w.LotteryGameLotteryWalletSafeBoxSystem)).withdrawERC20(this.TokenAddress)}async withdraw(){this.TokenType===l.ChainToken?await this.withdrawETH():await this.withdrawERC20()}static async create(t=l.ChainToken,i=B){if(!H.isWalletConnected)throw new Error("Wallet is not connected");const f=await d.instance.getContract(w.GameRoot).getContract(),e=await d.instance.getAddress(),o=await y.queryByKeys(f,[e,t,i],1),c=new h;return c.TokenType=t,c.TokenAddress=i,c.Owner=e,c.Amount=o.Amount,c}}function Q(){const[n,a]=p.useState(new h),t=async()=>{const e=await h.create();a(e)},i=async()=>{try{O(),await n.withdraw(),await t()}catch(e){u.error(e!=null&&e.message&&e.message.length<30?e.message:"claim failed")}finally{P()}},f=R();return p.useEffect(()=>{async function e(){await t()}try{e()}catch(o){u.error(o!=null&&o.message&&o.message.length<30?o.message:"claim failed")}},[f.pathname]),r.jsx(r.Fragment,{children:r.jsxs(C,{direction:"vertical",size:"large",style:{display:"grid",justifyContent:"center",alignContent:"center",minHeight:`${W}`},children:[r.jsx(z,{gutter:0,children:r.jsxs(G,{span:"auto",style:{maxWidth:"100%"},children:[r.jsx(k.Text,{style:{fontSize:70,fontFamily:"Eras Bold ITC",color:"white",display:"grid",justifyContent:"center",alignContent:"center",fontWeight:700},children:"Total Amount"}),r.jsx(k.Text,{style:{fontSize:60,fontFamily:"Arimo Hebrew Subset",fontWeight:700,color:"white",display:"grid",justifyContent:"center",alignContent:"center"},children:n.Amount+" "+n.tokenSymbol})]})}),r.jsx(C,{style:{display:"flex",justifyContent:"center",alignContent:"center"},children:r.jsx(L,{style:{fontSize:40,fontWeight:700,width:556,height:100,color:"white"},shape:"round",onClick:i,disabled:n.isEmpty,children:"Claim"})})]})})}export{Q as default};
